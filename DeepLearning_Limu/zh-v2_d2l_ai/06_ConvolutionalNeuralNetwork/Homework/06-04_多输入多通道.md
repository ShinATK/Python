### 6.4.5. 练习

#### 1. 假设我们有两个卷积核，大小分别为$k_1$和$k_2$（中间没有非线性激活函数）

##### （1）. 证明运算可以用单次卷积来表示

假定输入为$n_i$，连续经过两个卷积核的数学表示如下：$(n_i \ast k_1) \ast k_2$。根据卷积满足结合律，该公式可以改写为：$n_i \ast (k_1 \ast k_2) = n_i \ast K$，故连续两次经过卷积核等价于单次卷积核

##### （2）这个等效的单个卷积核的维数是多少呢

假定输入$X$的大小为$c_0 \times h_i \times w_i$，$k_1$的大小为$c_1 \times c_0 \times k_1 \times k_1$，$k_2$的大小为$c_2 \times c_1 \times k_2 \times k_2$。则最后输出大小为：$$c_1 \times (h-k_1+k_2+2) \times (w-k_1+k_2+2)$$

记，等价单次卷积核大小为$c_0 \times k_h \times k_w$，则根据卷积输出大小的计算公式：$(h-k_h+1) \times (w-k_w+1)$

则两种输出的大小应当相等，可得：

$$k_{h\ or\ w} = k_1 + k_2 - 1$$

#### 2. 假设输入为$c_i \times h \times w$，卷积核大小为$c_0 \times c_i \times k_h \times k_w$，填充为$(p_h, p_w)$，步幅为$(s_h, s_w)$

##### （1）前向传播的计算成本（乘法和加法）是多少？

假定输入$X$的大小为$c_i \times h_i \times w_i$，卷积核$k$的大小为$c_o \times c_i \times k_h \times k_w$。

（卷积窗口不是$1 \times 1$时）
对于卷积核大小的区域内，乘法次数为：$k_h \times k_w$，加法次数为$k_h \times k_w - 1$。

对于单个通道，输入大小的区域内横向纵向需要重复$\frac{h-k_h+2*p_h+s_h}{s_h} \cdot \frac{w-k_w+2*p_w+s_w}{s_w}$次，共有$c_i$个输入通道。同时需要在输出通道进行同样操作$c_o$次。

乘法：$(k_h \times k_w) \cdot \frac{h-k_h+2*p_h+s_h}{s_h} \cdot \frac{w-k_w+2*p_w+s_w}{s_w} \cdot c_i \cdot c_o$
加法：$(k_h \times k_w - 1) \cdot \frac{h-k_h+2*p_h+s_h}{s_h} \cdot \frac{w-k_w+2*p_w+s_w}{s_w} \cdot c_i \cdot c_o$

##### （2）内存占用

计算占用见（1）

##### （3）反向传播的内存占用
##### （4）反向传播的计算成本

#### 3. 如果将输入通道和输出通道数量加倍，计算量会增加多少？填充数量翻一番会怎么样？

#### 4. 卷积核高度和宽度是$k_h = k_w = 1$，前向传播的计算复杂度是多少？

乘法：代入2-（1）中公式
加法：由于卷积核只有一个单位像素，故卷积核区域内没有发生加法运算，直接计算2-（1）中公式括号右侧部分即可

#### 6. 当卷积窗口不是$1 \times 1$时，如何使用矩阵乘法实现卷积？

